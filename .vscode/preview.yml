autoOpen: false # æ‰“å¼€åº”ç”¨æ—¶æ˜¯å¦è‡ªåŠ¨å¼€å¯æ‰€æœ‰ä¸‹æ–¹appsçš„é¢„è§ˆ
apps:
  - port: 5000                # Flask é»˜è®¤ç«¯å£
    run: |
      # ========== å®‰è£…ç³»ç»Ÿä¾èµ– ==========
      apt-get update && apt-get install -y ffmpeg unzip wget

      # ========== å‡†å¤‡æ¨¡å‹ ==========
      mkdir -p /workspace/models
      if [ ! -d /workspace/models/vosk-model-small-cn-0.22 ]; then
        echo "ğŸ“¥ ä¸‹è½½å¹¶è§£å‹ Vosk ä¸­æ–‡æ¨¡å‹..."
        wget -O /workspace/models/vosk-model-small-cn-0.22.zip "https://hf-mirror.com/datasets/datxy/file/resolve/main/models/vosk-model-small-cn-0.22.zip?download=true"
        unzip -q /workspace/models/vosk-model-small-cn-0.22.zip -d /workspace/models/
      else
        echo "âœ… æ¨¡å‹å·²å­˜åœ¨ï¼Œè·³è¿‡ä¸‹è½½"
      fi

      # ========== å¯åŠ¨ Flask ==========
      cd /workspace
      conda create -n asr python=3.9 -y
      conda activate asr
      pip install -r requirements.txt
      python app.py
    root: /
    name: asr-flask-app
    description: Vosk ä¸­æ–‡è¯­éŸ³è¯†åˆ« Flask æœåŠ¡
    autoOpen: true
